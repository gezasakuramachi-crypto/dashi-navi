<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>鹿嶋のご神幸 山車ナビ</title>

    <!-- 基本レイアウト：ヘッダー固定 / マップは可変 / フッター固定 -->
    <style>
      :root{
        --header-h: 64px;       /* タイトル帯の高さ */
        --footer-h: 72px;       /* 下段メニューの高さ */
        --side-gap: 10px;       /* 画面端の余白 */
        --panel-w: 130px;       /* 交通規制パネルの幅(スマホ想定) */
        --shadow: 0 6px 18px rgba(0,0,0,.18);
        --radius: 14px;
        --brand: #cfa84a;       /* 金色っぽい */
      }

      html,body{height:100%;margin:0;padding:0;}
      body{
        display:flex;
        flex-direction:column;
        background:#000; /* 余白の黒化 */
        color:#222;
        font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Sans",
                     "Yu Gothic UI","YuGothic","Meiryo", Arial, sans-serif;
      }

      /* ヘッダー（タイトル画像を左寄せで） */
      header{
        height:var(--header-h);
        background:#000;
        display:flex; align-items:center;
        padding:0 var(--side-gap);
        position:sticky; top:0; z-index: 1100;
        border-bottom: 1px solid rgba(255,255,255,.08);
      }
      header .title-img{
        height: 60%; /* ご要望：縦を小さめに */
        object-fit: contain;
        display:block;
      }

      /* マップ領域（ヘッダーとフッターを除いた可変） */
      #mapWrap{ position:relative; flex:1; background:#111; }
      #map{ position:absolute; inset:0; }

      /* 右上：交通規制ボタン */
      .reg-btn{
        position:absolute; right:var(--side-gap); top:12px;
        background:#ff4b6e;
        color:#fff; font-weight:700; letter-spacing:.05em;
        border-radius:999px; padding:10px 12px; line-height:1;
        box-shadow: var(--shadow);
        z-index: 1001;
        user-select:none;
      }

      /* 右：交通規制サイドパネル（幅スリム） */
      .reg-panel{
        position:absolute; right:var(--side-gap); top:56px; bottom:var(--side-gap);
        width:var(--panel-w);
        background: rgba(255,255,255,.92); backdrop-filter: blur(6px);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow:auto; padding:10px;
        z-index:1001; display:none;
      }
      .reg-panel.open{ display:block; }
      .reg-panel h3{
        margin: 4px 0 8px; font-size:14px; text-align:left; color:#333;
      }
      .chip{
        display:block; width:100%;
        border:1px solid #cfd6e0; border-radius: 10px;
        padding:10px 8px; margin:8px 0;
        background:#fff; text-align:center; font-size:14px;
      }

      /* 左：表示切替（インフォ/トイレ/Ｐのみ） */
      .left-stack{
        position:absolute; left:var(--side-gap); top:calc(8px + env(safe-area-inset-top,0));
        z-index: 1001; display:flex; flex-direction:column; gap:10px;
      }
      .stack-box{
        background:#fff; border-radius: 16px; box-shadow: var(--shadow);
        padding:10px; display:flex; flex-direction:column; gap:10px;
      }
      .lbtn{
        width:54px; height:54px; display:grid; place-items:center;
        border-radius:12px; background:#f7f7f9; border:1px solid #e7e8ee;
      }
      .lbtn img{ width:36px; height:36px; display:block; }

      /* 画面タップでメニュー等を閉じる用のマスク */
      .scrim{
        position:absolute; inset:0; z-index:1000; display:none;
        background: transparent;
      }
      .scrim.show{ display:block; }

      /* 下段：フッターメニュー（アイコン＋ラベル） */
      footer{
        height:calc(var(--footer-h) + env(safe-area-inset-bottom));
        padding-bottom: env(safe-area-inset-bottom);
        background:#000; color:#fff;
        border-top: 1px solid rgba(255,255,255,.08);
      }
      .footer-inner{
        height:var(--footer-h);
        display:flex; align-items:center; justify-content:space-around;
      }
      .fbtn{
        display:flex; flex-direction:column; align-items:center; gap:6px;
        min-width:72px;
      }
      .fbtn img{
        width:36px; height:36px; display:block;
        filter:none;
      }
      .fbtn span{ font-size:12px; }

      /* 山車の情報ウィンドウ（コンパクト） */
      .dashi-card{
        min-width: 220px;
      }
      .dashi-title{ font-weight:700; font-size:16px; margin-bottom:2px; }
      .dashi-state{ color:#666; margin-bottom:6px; font-size:13px; }
      .pill{
        display:flex; align-items:center; gap:8px;
        border:1px solid #d9e0ea; background:#fff; border-radius:999px;
        padding:8px 12px; margin:6px 0; font-size:14px;
      }
      .dot{ width:8px; height:8px; border-radius:999px; background:#3478f6; display:inline-block; }

      /* 画面小の調整 */
      @media (max-width: 370px){
        :root{ --panel-w: 120px; }
        .fbtn{ min-width:64px; }
        .fbtn img{ width:32px; height:32px; }
      }
    </style>
  </head>

  <body>
    <!-- ヘッダー（タイトル画像は左寄せ） -->
    <header>
      <!-- ここは mark/title.png を使う想定（ユーザ様が置いたもの） -->
      <img class="title-img" src="mark/title.png" alt="鹿嶋のご神幸 タイトル" />
    </header>

    <!-- マップ本体 -->
    <main id="mapWrap">
      <div id="map"></div>

      <!-- 右上：交通規制 -->
      <div class="reg-btn" id="btnReg">交通<br/>規制</div>

      <!-- 右：スリムな交通規制パネル -->
      <aside class="reg-panel" id="regPanel">
        <h3>交通規制</h3>
        <button class="chip" data-day="9/1">9/1(月)</button>
        <button class="chip" data-day="9/2">9/2(火)</button>
        <div id="slotWrap"></div>
      </aside>

      <!-- 左：表示ON/OFF（インフォ / トイレ / P） -->
      <div class="left-stack">
        <div class="stack-box">
          <button class="lbtn" id="toggleInfo" title="インフォ">
            <img src="mark/info.png" alt="info" />
          </button>
          <button class="lbtn" id="toggleWc" title="トイレ">
            <img src="mark/wc.png" alt="toilet" />
          </button>
          <button class="lbtn" id="togglePark" title="駐車場">
            <img src="mark/parking.png" alt="parking" />
          </button>
        </div>
      </div>

      <!-- タップで閉じるマスク（サイドパネルや InfoWindow を閉じる） -->
      <div class="scrim" id="scrim"></div>
    </main>

    <!-- 下段：アイコン＋ラベルのメニュー -->
    <footer>
      <div class="footer-inner">
        <button class="fbtn" id="menuDashi">
          <img src="mark/sakura.png" alt="山車" />
          <span>山車</span>
        </button>
        <button class="fbtn" id="menuReg">
          <!-- 中心は白で塗りつぶされた版を想定（no_entry.png） -->
          <img src="mark/no_entry.png" alt="交通規制" />
          <span>交通規制</span>
        </button>
        <button class="fbtn" id="menuLoc">
          <img src="mark/myloc.png" alt="現在地" />
          <span>現在地</span>
        </button>
        <button class="fbtn" id="menuHelp">
          <img src="mark/help.png" alt="ヘルプ" />
          <span>ヘルプ</span>
        </button>
      </div>
    </footer>

    <!-- アプリ本体 -->
    <script src="./app.js"></script>

    <!-- Google Maps JS（※ご自身のキーに置換してください） -->
    <script async src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap&libraries=geometry"></script>
  </body>
</html>
